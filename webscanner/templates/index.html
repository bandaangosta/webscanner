{% extends "layout.html" %}
{% block body %}
<div class="container text-center">
	<h2>Web Scanner</h2>

	<button id="butScan" type="button" class="btn btn-primary btn-lg m-2">Scan document</button>
	<button id="butSave" type="button" class="btn btn-primary btn-lg m-2">Save copy</button>
	<button type="button" data-toggle="modal" data-target="#modalDownload" class="btn btn-primary btn-lg m-2">Download PDF</button>
	<button type="button" data-toggle="modal" data-target="#modalSendEmail" class="btn btn-primary btn-lg m-2">E-mail PDF</button>
	<br>
	<button id="butClear" type="button" class="btn btn-warning btn-lg m-2">Clear PDFs</button>
	<br>
	<br>
	Console:<br>
	 <textarea id="actions" style="width:100%; height: 100px" readonly></textarea>
</div>

<!-- Modal -->
<div class="modal fade" id="modalDownload" tabindex="-1" role="dialog" aria-labelledby="modalDownload" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Download scanned PDF</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
	   <div class="modal-body">
	   	<div class="form-group">
	   		<label for="fileNameDown">File name</label>
	     	<input id="fileNameDown" class="form-control" value="{{ config.DEFAULT_FILE_NAME }}" placeholder="You can define a DEFAULT_FILE_NAME" aria-label="enter file name here" name="fileNameDown">
	   	</div>
	   </div>
	   <div class="modal-footer">
	     <button id="butDownload" type="button" class="btn btn-primary">Download</button>
	   </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="modalSendEmail" tabindex="-1" role="dialog" aria-labelledby="modalSendEmail" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">E-mail scanned PDF</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
	   <div class="modal-body">
	   	<div class="form-group">
	   		<label for="recipient">Email address</label>
	     	<input type="email" id="recipient" class="form-control" value="{{ config.DEFAULT_RECIPIENT }}" placeholder="You can define a DEFAULT_RECIPIENT" aria-label="enter your e-mail here" name="recipient">
	   	</div>
	   	<div class="form-group">
	   		<label for="fileNameEmail">File name</label>
	     	<input id="fileNameEmail" class="form-control" value="{{ config.DEFAULT_FILE_NAME }}" placeholder="You can define a DEFAULT_FILE_NAME" aria-label="enter file name here" name="fileNameEmail">
	   	</div>
	   </div>
	   <div class="modal-footer">
	     <button id="butEmail" type="button" class="btn btn-primary">Send e-mail with PDF</button>
	   </div>
    </div>
  </div>
</div>

 <script>
	 $(document).ready(function(){
	 	$("#butScan").click(function(e) {	 	    
	 		$("#actions").html('Sending scan command. Please wait...');
	 	    $("#actions").load("{{ url_for('scanDo') }}");
	 	});
	 	$("#butSave").click(function(e) {	 	    
	 		$("#actions").html('Sending save command...');
	 	    $("#actions").load("{{ url_for('scanSave') }}");
	 	});
	 	$("#butDownload").click(function(e) {	 	    
	 	    $("#actions").html('Downloading scanned file...');
	 	    var url = "{{ url_for('scanDownload') }}";

	 		$('#modalDownload').modal('hide');	 			 		
	 		$(location).attr('href', url + '?filename=' + $('#fileNameDown').val());
	 	});
	 	$("#butEmail").click(function(e) {	 	  
	 		var url = "{{ url_for('scanEmail') }}";

	 		$('#modalSendEmail').modal('hide');	 		
	 		$("#actions").html('Sending file to ' + $('#recipient').val() + '...');	 		
	 	    $("#actions").load(url + '?email=' + $('#recipient').val() + '&filename=' + $('#fileNameEmail').val());
	 	});
	 	$("#butClear").click(function(e) {	
	 		$("#actions").html('Sending clear PDFs command...'); 	    
	 	    $("#actions").load("{{ url_for('scanClear') }}");
	 	});

	 });
 </script>

{% endblock %}
