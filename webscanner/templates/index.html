{% extends "layout.html" %}
{% block body %}
<div class="container text-center">
	<h2>Web Scanner</h2>

	<button id="butScan" type="button" class="btn btn-primary btn-lg m-2">Scan document</button>
	<button id="butSave" type="button" class="btn btn-primary btn-lg m-2">Save copy</button>
	<a id="butDownload" href="{{ url_for('scanDownload') }}" class="btn btn-primary btn-lg m-2">Download PDF</a>
	<button type="button" data-toggle="modal" data-target="#modalSendEmail" class="btn btn-primary btn-lg m-2">E-mail PDF!</button>
	<br>
	<button id="butClear" type="button" class="btn btn-warning btn-lg m-2">Clear PDFs</button>
	<br>
	<br>
	Action:<br>
	 <textarea id="actions" style="width:100%; height: 100px"></textarea>
</div>

<!-- Modal -->
<div class="modal fade" id="modalSendEmail" tabindex="-1" role="dialog" aria-labelledby="modalSendEmail" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Send to e-mail:</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
	   <div class="modal-body">
	     <input type="email" id="recipient" class="form-control" value="{{ config.DEFAULT_RECIPIENT }}" placeholder="You can define a DEFAULT_RECIPIENT" aria-label="enter your e-mail here" name="recipient">
	   </div>
	   <div class="modal-footer">
	     <button id="butEmail" type="button" class="btn btn-primary">Send e-mail with PDF</button>
	   </div>
    </div>
  </div>
</div>

 <script>
	 $(document).ready(function(){
	 	$("#butScan").click(function(e) {	 	    
	 	    $("#actions").load("{{ url_for('scanDo') }}");
	 	});
	 	$("#butSave").click(function(e) {	 	    
	 	    $("#actions").load("{{ url_for('scanSave') }}");
	 	});
	 	$("#butDownload").click(function(e) {	 	    
	 	    e.preventDefault();
	 	    $("#actions").html('Downloading scanned file...');
	 	    $(location).attr('href', $(this).attr("href"));
	 	});
	 	$("#butEmail").click(function(e) {	 	  
	 		var url = "{{ url_for('scanEmail') }}";

	 		$('#modalSendEmail').modal('hide');	 		
	 		$("#actions").html('Sending file to ' + $('#recipient').val() + '...');	 		
	 	    $("#actions").load(url + '?email=' + $('#recipient').val());
	 	});
	 	$("#butClear").click(function(e) {	 	    
	 	    $("#actions").load("{{ url_for('scanClear') }}");
	 	});

	 });
 </script>

{% endblock %}
